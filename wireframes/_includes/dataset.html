---
layout: basic
title: Dataset
nav: Datasets
---

<main role="main" id="content" tabindex="-1">
    <div class="jumbotron">
        <div class="container">
            <h1 class="display-4 font-weight-bold" id="mainTitle">Dataset</h1>
            <p><span id="updateDate">Last updated: 14/05/2020</span> by Rob Chambers (<a id="previous" href="previous"
                    class="text-decoration-underline">previous versions</a>).</p>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-9">
                <div class="bg-light p-4 d-md-inline-flex mb-5">
                    <p id="nav-page-sections-title" class="font-weight-bold mr-3 mb-0">On this page:</p>
                    <div role="navigation" aria-labelledby="nav-page-sections-title">
                        <ul class="list-unstyled d-md-inline-flex mb-0">
                            <li class="mr-md-3"><a href="#aboutThisDataset" class="text-decoration-underline">About this dataset</a></li>
                            <li class="mr-md-3"><a href="#ownership" class="text-decoration-underline">Ownership</a></li>
                            <li class="mr-md-3"><a href="#gdprReportingInformation" class="text-decoration-underline">GDPR reporting information</a></li>
                            {% if loggedIn == false %}<li><a href="#furtherInformation" class="text-decoration-underline">Further information</a></li>{% endif %}
                        </ul>
                    </div>
                </div>
                <h2 id="aboutThisDataset" class="pb-3">About this dataset</h2>
                <form>
                    <div class="form-group pb-1">
                        <label for="datasetTitle" class="form-label">Title</label>
                        {% if loggedIn == false %}
                        <input id="datasetTitle" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="datasetTitle" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="metadataCatalogueReference" class="form-label">Metadata or Application catalogue
                            reference</label>
                        {% if loggedIn == false %}
                        <input id="metadataCatalogueReference" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="metadataCatalogueReference" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <!-- <div class="form-group pb-1">
                        <label for="link" class="form-label">Link to dataset</label>
                        {% if loggedIn == false %}
                        <input id="link" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="link" type="text" class="form-control">
                        {% endif %}
                    </div> -->
                    <div class="form-group pb-1">
                        <fieldset>
                            <legend>Related links</legend>
                            {% if loggedIn == false %}
                            <label class="form-label" for="new-link-name">Link name</label>
                            <input class="form-control" id="new-link-name" name="new-link-name" value="Link URL"
                                type="text" readonly>
                            {% else %}
                            <label class="form-label" for="new-link-name">New link name</label>
                            <input class="form-control" id="new-link-name" name="new-link-name" type="text">
                            <label class="form-label" for="new-link-url">New link URL</label>
                            <input class="form-control" id="new-link-url" name="new-link-url" type="url">
                            <input class="btn btn-primary mb-2 rounded-0" name="new-link" type="submit"
                                value="Add new link">
                            {% endif %}
                        </fieldset>
                    </div>
                    <div class="form-group pb-1">
                        <label for="datasetType" class="form-label">Type</label>
                        {% if loggedIn == false %}
                        <input id="datasetType" type="text" class="form-control" readonly>
                        {% else %}
                        <select class="form-control" id="datasetType">
                            <option selected disabled>Please choose an option</option>
                            <option>dataset</option>
                            <option>reference</option>
                            <option>system</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="description" class="form-label">Description</label>
                        {% if loggedIn == false %}
                        <textarea class="form-control" id="description" rows="5" readonly></textarea>
                        {% else %}
                        <textarea class="form-control" id="description" rows="5"></textarea>
                        {% endif %}
                    </div>
                    {% if loggedIn == true %}
                    <div class="form-group pb-1">
                        <label for="input">Add a link to any datasets or systems this entry is dependent on:</label>
                        {% if loggedIn == false %}
                        <input id="input" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="input" type="text" class="form-control" readonly>
                        {% endif %}
                        {% if loggedIn == true %}
                        <a role="button" id="dependencies" href="dependencies/"
                            class="btn btn-primary mb-2 mt-2">Add/edit inputs</a>
                        {% endif %}
                    </div>
                    {% endif %}
                    <div class="form-group">
                        <label for="datasetID">Unique ID</label>
                        <input id="datasetID" type="text" class="form-control" readonly>
                    </div>
                    <h2 id="ownership" class="pb-3">Ownership</h2>
                    <div class="form-group pb-1">
                        <label for="inputOwner">Owner</label>
                        {% if loggedIn == false %}
                        <input id="inputOwner" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="inputOwner" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="contactName" class="form-label">Contact name</label>
                        {% if loggedIn == false %}
                        <input id="contactName" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactName" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="contactEmail" class="form-label">Contact email</label>
                        {% if loggedIn == false %}
                        <input id="contactEmail" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactEmail" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <!-- <h2 class="pb-3">Usage</h2>
                    <div class="form-group">
                        <label for="licence">Licence</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="licence" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/</option>
                            <option>https://choosealicense.com/licenses/apache-2.0/</option>
                            <option>https://choosealicense.com/licenses/gpl-3.0/</option>
                            <option>https://choosealicense.com/licenses/mpl-2.0/</option>
                            <option>https://choosealicense.com/licenses/mit/</option>
                        </select>
                        {% endif %}
                    </div> -->
                    <!-- <div class="form-group pb-1">
                        <label for="pia" class="form-label">Contains Personally identifiable information</label>
                        {% if loggedIn == false %}
                        <input id="pia" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="pia" type="text" class="form-control">
                        {% endif %}
                    </div> -->
                    <!-- <div class="form-group pb-1">
                        <label for="published" class="form-label">Published</label>
                        {% if loggedIn == false %}
                        <input id="published" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="published" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="objective" class="form-label">Dataset objective</label>
                        {% if loggedIn == false %}
                        <input id="objective" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="objective" type="text" class="form-control">
                        {% endif %}
                    </div> -->
                    <div class="form-group">
                        <label for="licence">Security classification</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="eea-storage" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>TBD</option>
                        </select>
                        {% endif %}
                    </div>

                    <!-- new GDPR section -->
                    <h2 id="gdprReportingInformation" class="pb-3">GDPR reporting information</h2>
                    <h3>Personal data</h3>
                    <div class="form-group">
                        <label for="pia">Does the system/dataset contain personal data?</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="pia" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="pia">
                            <option selected disabled>Please choose an option</option>
                            <option>Yes</option>
                            <option>No</option>
                        </select>
                        {% endif %}
                    </div>
                    {% if loggedIn == true %}
                    <p><strong>If no, you do not need to complete any more of the personal data section</strong></p>
                    <p>If you have any queries about how to complete this contact your custodian or the <a
                            href="mailto:insert@email.here">Data Protection team</a></p>
                    {% endif %}
                    <div class="form-group">
                        <label for="isTheEA">Is the EA a:</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="isTheEA" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="isTheEA">
                            <option selected disabled>Please choose an option</option>
                            <option>Controller (sole)</option>
                            <option>Controller (joint)</option>
                            <option>Processor</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        If the EA is a joint controller or processor, add the name(s) and contact details of the (other)
                        controller organisation(s):
                        <label for="contactNameJC" class="form-label">Name</label>
                        {% if loggedIn == false %}
                        <input id="contactEmailJC" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactEmailJC" type="text" class="form-control">
                        <label for="contactEmailJC" class="form-label">Contact details</label>
                        {% if loggedIn == false %}
                        <textarea class="form-control" id="description" rows="5" readonly></textarea>
                        {% else %}
                        <textarea class="form-control" id="description" rows="5"></textarea>
                        {% endif %}
                        <input class="btn btn-primary mb-2 rounded-0" name="new-link" type="submit"
                            value="Add new contact">
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label for="licence">Are you using a data processor?</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="eea-storage" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>Yes</option>
                            <option>No</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">If yes, link to Processing Agreement</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">Provide a link to the privacy notice provided to
                            data subjects:</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <p>What is the purpose or purposes for processing the personal data (this should be described in
                            more detail in the privacy notice you provide to data subjects):</p>
                        {%- for item in gdpr.purposes -%}
                        <div>
                            <input id="{{item.purpose}}" aria-describedby="purpose of processing {{item.purpose}}"
                                type="checkbox" />
                            <label style="display:inline" for="{{item.purpose}}">{{item.purpose}}</label>
                        </div>
                        {% endfor %}
                    </div>
                    <div id="Categories of Personal Data" class="form-group pb-1">
                        <h4>Categories of Personal Data</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>
                                        Category
                                    </th>
                                    <th id="included">
                                        Included in this dataset
                                    </th>
                                    <th>
                                        Is yes please provide details
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {%- for item in gdpr.categories-of-personal-data -%}
                                <tr>
                                    <td>
                                        {{item.category}}
                                    </td>
                                    <td>
                                        <input aria-describedby="included" type="checkbox" />
                                    </td>
                                    <td>
                                        {% if loggedIn == false %}
                                        <a href = "personal-details?{{item.category}}#Categories of Personal Data">View additional details</a>
                                        {% else %}
                                        <a href = "personal-details?{{item.category}}#Categories of Personal Data">Add additional details</a>
                                        {% endif %}
                                    </td>
                                </tr>
                                    {%- endfor -%}
                            </tbody>
                        </table>
                    </div>
                    <div class="form-group pb-1">
                        <label for="datasetTitle" class="form-label">Is there a Data Protection Impact Assessment (DPIA) to cover this processing?<br>
                            <small>If unsure contact your Exec custodian. If you have included any of the categories of personal data in blue or green above a DPIA is required.</small></label>
                        {% if loggedIn == false %}
                        <input id="datasetTitle" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="datasetTitle" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="datasetTitle" class="form-label">If yes, please provide link</label>
                        {% if loggedIn == false %}
                        <input id="datasetTitle" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="datasetTitle" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <h3>Data storage and use</h3>
                    <div class="form-group pb-1">
                        <label for="datasetTitle" class="form-label">Will the personal data be shared with any other parties</label>
                        {% if loggedIn == false %}
                        <input id="datasetTitle" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="datasetTitle" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <p>If yes, which categories of recipients will the information be shared with?</p>
                        {%- for item in gdpr.categories-recipients -%}
                        <div>
                            <input id="recipients-{{item.recipients}}" aria-describedby="categories of recipients of {{item.recipients}}"
                                type="checkbox" />
                            <label style="display:inline" for="{{item.recipients}}">{{item.recipients}}</label>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="form-group">
                        <label for="licence">Will the personal data be stored or transferred outside the UK?</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="eea-storage" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>Yes</option>
                            <option>No</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label for="licence">If yes, please state which country:</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="eea-storage" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            {%- for item in countries -%}
                            <option>{{item.name}}</option>
                            {% endfor %}
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">If yes, please add Third Party data supply agreement (link to
                            document)</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>

                    <!-- new GDPR section ends-->

                    {% if loggedIn == true %}
                    <a role="button" href="../" class="btn btn-primary mb-2 btn-lg">Save and publish</a> <a
                        class="p-3 text-decoration-underline" href="../">Cancel</a>
                    {% endif %}
                </form>
                {% if loggedIn == false %}
                <h2 id="furtherInformation" class="pb-3">Further information</h2>
                <p>Please note: The following data is not entered but is calculated or inferred from other data or
                    connections within DFM</p>
                <h2>Dataset connections (example)</h2>
                <!-- <h3>Dataset connections (example)</h3> -->
                <svg id="diagram" width="1000" height="300">
                </svg>
                {%- for item in queries.oneDataset -%}
                <h3>
                    {{item.name}}
                </h3>
                <div class="p-3 mb-2 bg-light text-dark" style="height: 100px"><br>{query results go here}</div>
                {%- endfor -%}
                {% endif %}
            </div>
        </div>
    </div>
</main>

<script>
    let URL = window.location.href
    let parameters = URL.split("?id=")[1]
    let newInputDataset = parameters.split("&")[1]
    let dataset = parameters.split("&")[0]
    newInputDataset = parameters.split("=")[1]
    if (dataset != 0) {
        if (window.location.href.indexOf("authenticated") > -1) {
            document.getElementById("dependencies").href = "dependencies/index.html?id=" + dataset
        }
        document.getElementById("previous").href = "previous?id=" + dataset
        fetch('/assets/datasets.json')
            .then(response => response.json())
            .then(input => {
                let data = input;
                let dataset = data.find(findDataset)
                document.getElementById("mainTitle").innerHTML = dataset.datasetName
                document.getElementById("datasetID").value = dataset.datasetID
                document.getElementById("datasetTitle").value = dataset.datasetName
                document.getElementById("inputOwner").value = dataset.ownerName
                // document.getElementById("input").value = dataset.uses
                document.getElementById("licence").value = dataset.licence
                document.getElementById("datasetType").value = dataset.datasetType
                document.getElementById("contactName").value = dataset.contactName
                document.getElementById("contactEmail").value = dataset.contactEmail
                // document.getElementById("published").value = dataset.published
                // document.getElementById("link").value = dataset.link
                document.getElementById("description").value = dataset.description
                document.getElementById("metadataCatalogueReference").value = dataset.metadataCatalogueReference
                // document.getElementById("objective").value = dataset.objective
                document.getElementById("updateDate").innerHTML = "Last updated: " + dataset.updateDate
                if (dataset.pia === "y") {
                    document.getElementById("pia").value = "Yes, personal"
                } else {
                    document.getElementById("pia").value = "No"
                }
                if (newInputDataset != 0) {
                    document.getElementById("input").value = newInputDataset + "," + dataset.uses
                }
            });
    } else {
        document.getElementById("datasetTitle").removeAttribute('readonly')
        document.getElementById("dependencies").classList.add('disabled')
        document.getElementById("mainTitle").innerHTML = "Create new dataset"
    }
    findDataset = (input) => {
        return input.datasetID === dataset;
    }
</script>
<script>
    // const dataset = "dataset1";

    const datasetInput = [{
        "name": "dataset2"
    }, {
        "name": "dataset3"
    }, {
        "name": "dataset4"
    }, {
        "name": "dataset5"
    }]
    const datasetOutput = [{
        "name": "dataset6"
    }, {
        "name": "dataset7"
    }, {
        "name": "dataset7"
    }]

    const countOfInput = datasetInput.length
    const countOfOutput = datasetOutput.length
    const boxYGap = 10;
    const boxXGap = 10;
    const boxHeight = 50;
    const boxWidth = 180;
    const padding = 15;
    const textPadding = 20;
    const outputDistance = 540;
    const thisDataset = (outputDistance) / 2;
    const thisDatasetHeight = (Math.min(countOfInput, countOfOutput) / 2) * boxHeight
    const boxColour = "#e9ecef";
    const linkColour = "stroke:rgb(0,0,0)";
    const textColour = "";
    const boxStroke = "#1c52a4";
    const boxStrokeWidth = 2



    let inputSVGDetail = ""
    let outputSVGDetail = ""

    let x = boxXGap + thisDataset;
    let y = boxYGap + thisDatasetHeight;
    let textX = boxXGap + textPadding + thisDataset;
    let textY = boxYGap + textPadding + thisDatasetHeight;
    thisDatasetSVGDetail =
        "<rect x='" + x + "' y='" + y + "' width='" + boxWidth + "' height='" + boxHeight + "' stroke='" + boxStroke +
        "' stroke-width='" + boxStrokeWidth + "' fill='" + boxColour + "' />" +
        "<text x='" + textX + "' y='" + textY + "' fill='" + textColour + "'> " + dataset + " </text>"

    for (i = 0; i < countOfInput; i++) {
        let x = boxXGap;
        let y = boxYGap + ((boxHeight + padding) * i);
        let width = boxWidth
        let height = boxHeight
        let textX = boxXGap + textPadding
        let textY = (boxYGap + textPadding) + ((boxHeight + padding) * i);
        let lineX1 = boxWidth + boxYGap
        let lineX2 = boxHeight / 2 + boxYGap + ((boxHeight + padding) * i);
        let lineY1 = boxXGap + thisDataset;
        let lineY2 = boxHeight / 2 + boxYGap + thisDatasetHeight;
        inputSVGDetail = inputSVGDetail +
            "<a href='/datasets/dataset/?id=" + datasetInput[i].name + "&new='><rect x='" + x + "' y='" + y +
            "' width='" + width + "' height='" + height + "' stroke='" + boxStroke + "' stroke-width='" +
            boxStrokeWidth + "' fill='" + boxColour + "' /></a>" +
            "<a href='/datasets/dataset/?id=" + datasetInput[i].name + "&new='><text x='" + textX + "' y='" + textY +
            "' fill='" + textColour + "'> " + datasetInput[i].name + " </text></a>" +
            "<line x1='" + lineX1 + "' y1='" + lineX2 + "' x2='" + lineY1 + "' y2='" + lineY2 + "' style='" +
            linkColour + ";stroke-width:2' />"
    }

    for (i = 0; i < countOfOutput; i++) {
        let x = boxXGap + outputDistance;
        let y = boxYGap + ((boxHeight + padding) * i);
        let width = boxWidth
        let height = boxHeight
        let textX = boxXGap + textPadding + +outputDistance
        let textY = (boxYGap + textPadding) + ((boxHeight + padding) * i);
        let lineX1 = boxXGap + thisDataset + boxWidth;
        let lineX2 = boxHeight / 2 + boxYGap + thisDatasetHeight;
        let lineY1 = x;
        let lineY2 = boxHeight / 2 + boxYGap + ((boxHeight + padding) * i);
        outputSVGDetail = outputSVGDetail +
            "<a href='/datasets/dataset/?id=" + datasetOutput[i].name + "&new='><rect x='" + x + "' y='" + y +
            "' width='" + width + "' height='" + height + "' stroke='" + boxStroke + "' stroke-width='" +
            boxStrokeWidth + "' fill='" + boxColour + "' /></a>" +
            "<a href='/datasets/dataset/?id=" + datasetOutput[i].name + "&new='><text x='" + textX + "' y='" + textY +
            "' fill='" + textColour + "'> " + datasetOutput[i].name + " </text></a>" +
            "<line x1='" + lineX1 + "' y1='" + lineX2 + "' x2='" + lineY1 + "' y2='" + lineY2 + "' style='" +
            linkColour + ";stroke-width:2' />"
    }

    document.getElementById('diagram').innerHTML = inputSVGDetail + thisDatasetSVGDetail + outputSVGDetail
</script>