---
layout: basic
title: Dataset
nav: Datasets
---

<main role="main" id="content">
    <div class="jumbotron">
        <div class="container">
            <h1 class="display-4 font-weight-bold" id="mainTitle">Dataset</h1>
            <p><span id="updateDate">Last updated: 14/05/2020</span> by Rob Chambers (<a id="previous"
                    href="previous">previous versions</a>)</p>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <h2 class="pb-3">About this dataset</h2>
                <form>
                    <div class="form-group pb-1">
                        <label for="datasetTitle" class="form-label">Dataset title</label>
                        {% if loggedIn == false %}
                        <input id="datasetTitle" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="datasetTitle" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="metadataCatalogueReference" class="form-label">Metadata or Application catalogue
                            reference</label>
                        {% if loggedIn == false %}
                        <input id="metadataCatalogueReference" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="metadataCatalogueReference" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <!-- <div class="form-group pb-1">
                        <label for="link" class="form-label">Link to dataset</label>
                        {% if loggedIn == false %}
                        <input id="link" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="link" type="text" class="form-control">
                        {% endif %}
                    </div> -->
                    <div class="form-group pb-1">
                    <fieldset>
                        <legend>Related links</legend>
                        {% if loggedIn == false %}
                        <label class="form-label" for="new-link-name">Link name</label>
                        <input class="form-control" id="new-link-name" name="new-link-name" value="Link URL" type="text"
                            readonly>
                        {% else %}
                        <label class="form-label" for="new-link-name">New link name</label>
                        <input class="form-control" id="new-link-name" name="new-link-name" type="text">
                        <label class="form-label" for="new-link-url">New link URL</label>
                        <input class="form-control" id="new-link-url" name="new-link-url" type="url">
                        <input class="btn btn-primary mb-2 rounded-0" name="new-link" type="submit"
                            value="Add new link">
                        {% endif %}
                    </fieldset>
                </div>
                    <div class="form-group pb-1">
                        <label for="datasetType" class="form-label">Dataset type</label>
                        {% if loggedIn == false %}
                        <input id="datasetType" type="text" class="form-control" readonly>
                        {% else %}
                        <select class="form-control" id="datasetType">
                            <option selected disabled>Please choose an option</option>
                            <option>dataset</option>
                            <option>reference</option>
                            <option>system</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="description" class="form-label">Description</label>
                        {% if loggedIn == false %}
                        <textarea class="form-control" id="description" rows="5" readonly></textarea>
                        {% else %}
                        <textarea class="form-control" id="description" rows="5"></textarea>
                        {% endif %}
                    </div>
                    {% if loggedIn == true %}
                    <div class="form-group pb-1">
                        <label for="input">Input datasets</label>
                        {% if loggedIn == false %}
                        <input id="input" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="input" type="text" class="form-control" readonly>
                        {% endif %}
                        {% if loggedIn == true %}
                        <a role="button" id="dependencies" href="dependencies/"
                            class="btn btn-primary rounded-0 mb-2 mt-2">Add/edit input datasets</a>
                        {% endif %}
                    </div>
                    {% endif %}
                    <div class="form-group">
                        <label for="datasetID">Dataset ID</label>
                        <input id="datasetID" type="text" class="form-control" readonly>
                    </div>
                    <h2 class="pb-3">Ownership</h2>
                    <div class="form-group pb-1">
                        <label for="inputOwner">Owner</label>
                        {% if loggedIn == false %}
                        <input id="inputOwner" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="inputOwner" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="contactName" class="form-label">Contact name</label>
                        {% if loggedIn == false %}
                        <input id="contactName" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactName" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="contactEmail" class="form-label">Contact email</label>
                        {% if loggedIn == false %}
                        <input id="contactEmail" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactEmail" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <!-- <h2 class="pb-3">Usage</h2>
                    <div class="form-group">
                        <label for="licence">Licence</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="licence" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/</option>
                            <option>https://choosealicense.com/licenses/apache-2.0/</option>
                            <option>https://choosealicense.com/licenses/gpl-3.0/</option>
                            <option>https://choosealicense.com/licenses/mpl-2.0/</option>
                            <option>https://choosealicense.com/licenses/mit/</option>
                        </select>
                        {% endif %}
                    </div> -->
                    <!-- <div class="form-group pb-1">
                        <label for="pia" class="form-label">Contains Personally identifiable information</label>
                        {% if loggedIn == false %}
                        <input id="pia" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="pia" type="text" class="form-control">
                        {% endif %}
                    </div> -->
                    <!-- <div class="form-group pb-1">
                        <label for="published" class="form-label">Published</label>
                        {% if loggedIn == false %}
                        <input id="published" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="published" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="objective" class="form-label">Dataset objective</label>
                        {% if loggedIn == false %}
                        <input id="objective" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="objective" type="text" class="form-control">
                        {% endif %}
                    </div> -->


                    <!-- new GDPR section -->
                    <h2 class="pb-3">GDPR reporting information</h2>
                    <h3>Personal data</h3>
                    <div class="form-group">
                        <label for="pia">Contains personal data</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="pia" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="pia">
                            <option selected disabled>Please choose an option</option>
                            <option>Yes, personal</option>
                            <option>Yes, personal sensitive</option>
                            <option>No</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label for="licence">Where personal data present, EA are:</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="licence" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>Controller</option>
                            <option>Joint controller</option>
                            <option>Processor</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="contactNamePI" class="form-label">Contact name (Joint Controllers and/or
                            Processers)</label>
                        {% if loggedIn == false %}
                        <input id="contactNamePI" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactNamePI" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="contactEmailPI" class="form-label">Contact email (Joint Controllers and/or
                            Processers)</label>
                        {% if loggedIn == false %}
                        <input id="contactEmailPI" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="contactEmailPI" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <h3>Data storage and use</h3>
                    <div class="form-group">
                        <label for="licence">Is data stored outside the EEA?</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="eea-storage" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>Yes</option>
                            <option>No</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">If yes, link to agreement</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">Link to Processing Agreement (where
                            applicable)</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">Number of individuals included in the
                            data</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">Link to Retention Schedule</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label for="licence">Security classification</label>
                        {% if loggedIn == false %}
                        <div class="form-group pb-1">
                            <input id="eea-storage" type="text" class="form-control" readonly>
                        </div>
                        {% else %}
                        <select class="form-control" id="licence">
                            <option selected disabled>Please choose an option</option>
                            <option>TBD</option>
                        </select>
                        {% endif %}
                    </div>
                    <div class="form-group pb-1">
                        <label for="linkToAgreement" class="form-label">Third Party data supply (link to
                            document)</label>
                        {% if loggedIn == false %}
                        <input id="linkToAgreement" type="text" class="form-control" readonly>
                        {% else %}
                        <input id="linkToAgreement" type="text" class="form-control">
                        {% endif %}
                    </div>

                    <!-- new GDPR section ends-->

                    {% if loggedIn == true %}
                    <a role="button" href="../" class="btn btn-primary mb-2 btn-lg rounded-0">Save and publish</a> <a
                        class="p-3" href="../">Cancel</a>
                    {% endif %}
                </form>
                {% if loggedIn == false %}
                <!-- <h2 class="pb-3">Further information</h2>
                <p>Please note: The following data is not entered but is calculated or inferred from other data or
                    connections within DFM</p> -->
                <h2>Dataset connections (example)</h2>
                <!-- <h3>Dataset connections (example)</h3> -->
                <svg id="diagram" width="1000" height="300">
                </svg>
                <!-- {%- for item in queries.oneDataset -%}
                <h3>
                    {{item.name}}
                </h3>
                <div class="p-3 mb-2 bg-light text-dark" style="height: 100px"><br>{query results go here}</div>
                {%- endfor -%} -->
                {% endif %}
            </div>
        </div>
    </div>
</main>

<script>
    let URL = window.location.href
    let parameters = URL.split("?id=")[1]
    let newInputDataset = parameters.split("&")[1]
    let dataset = parameters.split("&")[0]
    newInputDataset = parameters.split("=")[1]
    if (dataset != 0) {
        if (window.location.href.indexOf("authenticated") > -1) {
            document.getElementById("dependencies").href = "dependencies/index.html?id=" + dataset
        }
        document.getElementById("previous").href = "previous?id=" + dataset
        fetch('/assets/datasets.json')
            .then(response => response.json())
            .then(input => {
                let data = input;
                let dataset = data.find(findDataset)
                document.getElementById("mainTitle").innerHTML = dataset.datasetName
                document.getElementById("datasetID").value = dataset.datasetID
                document.getElementById("datasetTitle").value = dataset.datasetName
                document.getElementById("inputOwner").value = dataset.ownerName
                // document.getElementById("input").value = dataset.uses
                document.getElementById("licence").value = dataset.licence
                document.getElementById("datasetType").value = dataset.datasetType
                document.getElementById("contactName").value = dataset.contactName
                document.getElementById("contactEmail").value = dataset.contactEmail
                // document.getElementById("published").value = dataset.published
                // document.getElementById("link").value = dataset.link
                document.getElementById("description").value = dataset.description
                document.getElementById("metadataCatalogueReference").value = dataset.metadataCatalogueReference
                // document.getElementById("objective").value = dataset.objective
                document.getElementById("updateDate").innerHTML = "Last updated: " + dataset.updateDate
                if (dataset.pia === "y") {
                    document.getElementById("pia").value = "Yes, personal"
                } else {
                    document.getElementById("pia").value = "No"
                }
                if (newInputDataset != 0) {
                    document.getElementById("input").value = newInputDataset + "," + dataset.uses
                }
            });
    } else {
        document.getElementById("datasetTitle").removeAttribute('readonly')
        document.getElementById("dependencies").classList.add('disabled')
        document.getElementById("mainTitle").innerHTML = "Create new dataset"
    }
    findDataset = (input) => {
        return input.datasetID === dataset;
    }
</script>
<script>
    // const dataset = "dataset1";

    const datasetInput = [{
        "name": "dataset2"
    }, {
        "name": "dataset3"
    }, {
        "name": "dataset4"
    }, {
        "name": "dataset5"
    }]
    const datasetOutput = [{
        "name": "dataset6"
    }, {
        "name": "dataset7"
    }, {
        "name": "dataset7"
    }]

    const countOfInput = datasetInput.length
    const countOfOutput = datasetOutput.length
    const boxYGap = 10;
    const boxXGap = 10;
    const boxHeight = 50;
    const boxWidth = 180;
    const padding = 15;
    const textPadding = 20;
    const outputDistance = 540;
    const thisDataset = (outputDistance) / 2;
    const thisDatasetHeight = (Math.min(countOfInput, countOfOutput) / 2) * boxHeight
    const boxColour = "#e9ecef";
    const linkColour = "stroke:rgb(0,0,0)";
    const textColour = "";
    const boxStroke = "#1c52a4";
    const boxStrokeWidth = 2



    let inputSVGDetail = ""
    let outputSVGDetail = ""

    let x = boxXGap + thisDataset;
    let y = boxYGap + thisDatasetHeight;
    let textX = boxXGap + textPadding + thisDataset;
    let textY = boxYGap + textPadding + thisDatasetHeight;
    thisDatasetSVGDetail =
        "<rect x='" + x + "' y='" + y + "' width='" + boxWidth + "' height='" + boxHeight + "' stroke='" + boxStroke +
        "' stroke-width='" + boxStrokeWidth + "' fill='" + boxColour + "' />" +
        "<text x='" + textX + "' y='" + textY + "' fill='" + textColour + "'> " + dataset + " </text>"

    for (i = 0; i < countOfInput; i++) {
        let x = boxXGap;
        let y = boxYGap + ((boxHeight + padding) * i);
        let width = boxWidth
        let height = boxHeight
        let textX = boxXGap + textPadding
        let textY = (boxYGap + textPadding) + ((boxHeight + padding) * i);
        let lineX1 = boxWidth + boxYGap
        let lineX2 = boxHeight / 2 + boxYGap + ((boxHeight + padding) * i);
        let lineY1 = boxXGap + thisDataset;
        let lineY2 = boxHeight / 2 + boxYGap + thisDatasetHeight;
        inputSVGDetail = inputSVGDetail +
            "<a href='/datasets/dataset/?id=" + datasetInput[i].name + "&new='><rect x='" + x + "' y='" + y +
            "' width='" + width + "' height='" + height + "' stroke='" + boxStroke + "' stroke-width='" +
            boxStrokeWidth + "' fill='" + boxColour + "' /></a>" +
            "<a href='/datasets/dataset/?id=" + datasetInput[i].name + "&new='><text x='" + textX + "' y='" + textY +
            "' fill='" + textColour + "'> " + datasetInput[i].name + " </text></a>" +
            "<line x1='" + lineX1 + "' y1='" + lineX2 + "' x2='" + lineY1 + "' y2='" + lineY2 + "' style='" +
            linkColour + ";stroke-width:2' />"
    }

    for (i = 0; i < countOfOutput; i++) {
        let x = boxXGap + outputDistance;
        let y = boxYGap + ((boxHeight + padding) * i);
        let width = boxWidth
        let height = boxHeight
        let textX = boxXGap + textPadding + +outputDistance
        let textY = (boxYGap + textPadding) + ((boxHeight + padding) * i);
        let lineX1 = boxXGap + thisDataset + boxWidth;
        let lineX2 = boxHeight / 2 + boxYGap + thisDatasetHeight;
        let lineY1 = x;
        let lineY2 = boxHeight / 2 + boxYGap + ((boxHeight + padding) * i);
        outputSVGDetail = outputSVGDetail +
            "<a href='/datasets/dataset/?id=" + datasetOutput[i].name + "&new='><rect x='" + x + "' y='" + y +
            "' width='" + width + "' height='" + height + "' stroke='" + boxStroke + "' stroke-width='" +
            boxStrokeWidth + "' fill='" + boxColour + "' /></a>" +
            "<a href='/datasets/dataset/?id=" + datasetOutput[i].name + "&new='><text x='" + textX + "' y='" + textY +
            "' fill='" + textColour + "'> " + datasetOutput[i].name + " </text></a>" +
            "<line x1='" + lineX1 + "' y1='" + lineX2 + "' x2='" + lineY1 + "' y2='" + lineY2 + "' style='" +
            linkColour + ";stroke-width:2' />"
    }

    document.getElementById('diagram').innerHTML = inputSVGDetail + thisDatasetSVGDetail + outputSVGDetail
</script>